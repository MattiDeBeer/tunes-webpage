<!-- public/dashboard.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

   <!-- Fullscreen Modal for Terms and Conditions -->
   <div id="termsModal" class="terms-modal">
    <div style="z-index: 1001;">
        <h2 id = "alert-title" style="color: white;"></h2>
        <div id="terms-text">
        </div>

        
        <div id="table-div" style="display: none;" class="sign-in-table-container">
          <table border="1" class="sign-in-table">
              <thead>
                  <tr>
                      <th>Name</th>
                      <th>Organisation</th>
                      <th>Phone Number</th>
                      <th>Email</th>
                  </tr>
              </thead>
              <tbody id="signinLogsTableBody">
                  <!-- Logs will be inserted here -->
              </tbody>
          </table>
        </div>

        <div style="display: flex; flex-direction: column;">
        <button id="acceptBtn" style="margin-top: 10px; background-color: rgb(255, 0, 0);">Continue</button>
        <button id="declineBtn" style="margin-top: 10px; background-color: rgb(46, 156, 24);">Cancel</button>
        <button id="dismissBtn" style="margin-top: 10px; display: none;">Dismiss</button>
        </div>
    </div>
</div>
   
   <!-- Navigation Bar -->
   <nav class="navbar">
    <div class="logo">
        <a href="/"><img src="/images/tunes-logo.png" alt="Logo"></a>
      </div>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="signup.html">Register</a></li>
      <li><a href="contact.html">Contact</a></li>
    </ul>
    <button class="menu-toggle">&#9776;</button>
  </nav>


  <!-- Parent Container -->
  <div class="dashboard-wrapper">

    <div class="admin-container-flex">
      <h1>General</h1>
    </div>

    <div class="dashboard-container">
      <!-- User Info Column -->
      <div class="dashboard-column user-info">
        <h1>Welcome Admin, <span id="name">Loading...</span></h1>
        <p>Email: <span id="email">Loading...</span></p>
        <p>Organisation: <span id="organisation">Loading...</span></p>
        <p>Signed in: <span id="signedInLabel">Loading...</span></p>
        <p>There are currently <span id="signed-in-users" style="color: rgb(5, 155, 5);"">Loading ...</span> people on the festival site</p>
        <p>There are <span id="total-users">Loading ...</span> Regisered users</p>
        <div style="margin-top: auto">
          <button id = "qr-redirect">QR scanner</button>
          <button id="logout", class = logout-button>Logout</button>
        </div>
      </div>

      <!-- Additional Content Column -->
      <div class="dashboard-column extra-content">
        <h2>QR code</h2>
      <img id="qrCodeImg" alt="Your QR Code" style="margin-top: 20px;">
      </div>

    </div>

    <div class="admin-container-flex">
      <h1>Edit user details</h1>
    </div>

    <!-- Empty Box Below Dashboard Container -->
    <div class="admin-container">
      <!-- User Data Box -->
      <div class="admin-column">
      <h2>Enter the email you which to edit</h2>
  
  <form id="getUserForm">
    <div class="form-group">
      <label for="email">Email:</label>
      <input type="email" class="text-field" id="getEmail" name="email" value="Enter an email address ..." required>
    </div>
    <button id ="get-user-details" type="submit", class="button">Get info</button>
  </form>
  <p id = "fetch-message", class="message"> </p>
      </div>
      

      <div class="admin-column">
        <h2 id = "userDetailsTitle">Specify a detail you which to edit</h2>
        <p>Name:</p>
        <button id="changeName" class="change-detail-button"></button>
        <p>Email:</p>
        <button id="changeEmail" class="change-detail-button"></button>
        <p>Organisation:</p>
        <button id="changeOrganisation" class="change-detail-button"></button>
        <p>Phone Number:</p>
        <button id="changePhoneNumber" class="change-detail-button"></button>
      
        <p id="nameLabel">Admin: </p>
        <button id="changeAdmin" class="change-detail-button"></button>

        <p id="emailLabel">Signed In </p>
        <button id="changeSignedIn" class="change-detail-button"></button>

        <p>Admin Settings</p>
        <button id="changePassword" class="change-password-button"></button>
        <button id ="deleteUser", class = "delete-user-button"></button>
        

      </div>  

      <div class="admin-column">
        <h2 id = "ChangeUserDetailsTitle">Enter new details</h2>
        <!-- Normal submission form-->
        <form id="changeDetailForm" style="display: none;" >
          <div class="form-group">
          <label for="changeDetailInput1"></label>
          <input type="text" id="changeDetailInput1" class="text-field" name="changeDetail"  required>
          <label for="changeDetailInput2"></label>
          <input type="text" id="changeDetailInput2" class="text-field" name="changeDetail"  required>
          </div>
        <button type="submit", class="button">Change Detail</button>
        </form>

        <!--  Binary submission form -->
        <form id="changeDetailFormBinary" style="display: none;" >
          <div class = "side-by-side">
            <label for="adminToggle" style="font-size: 1.5em;">Toggle:</label>
            <input type="checkbox" id="toggle" checked>
          </div>
          <button type="submit">Update User</button>
      </form>
      <p id="change-user-message" class="message"> </p>
    </div>
    </div>

    <div class="admin-container-flex">
      <div class="admin-column">
        <button id="fetch-all-users-button" style="margin-bottom: 10px;">Load Users</button>
        <div class="table-container">
          <table id="userTable">
              <thead>
                  <tr>
                      <th>Name</th>
                      <th>Email</th>
                      <th>Role</th>
                      <th>Signed In</th>
                      <th>Edit user</th>
                  </tr>
              </thead>
              <tbody>
                  <!-- User data will go here -->
              </tbody>
          </table>
      </div>
      
      </div>
  
      </div>

      <div class="admin-container-flex">
        <h1>Current Issues</h1>
      </div>

    <div class="admin-container-flex">
      <div class="admin-column">
        <button id="fetch-all-issues-button" style="margin-bottom: 10px;">Load Issues</button>
        <div class="table-container">
          <table id="issuesTable" style="max-height: 700px;">
              <thead>
                  <tr>
                      <th>Email</th>
                      <th>Message</th>
                      <th>Created At</th>
                      <th>Resolve</th>
                  </tr>
              </thead>
              <tbody>
                  <!-- Issues will be inserted here dynamically -->
              </tbody>
          </table>
      </div>
      
      </div>

    </div>

    <div class="admin-container-flex">
      <h1>Alerts and Logs</h1>
    </div>

    <div class="admin-container">

      <div class="admin-column">
        
        <div class="contact-container">
          <h2>Write an alert</h2>
          <input type="text" id="alertSeverity" placeholder=" 'info' 'warning' or 'critical' " autocomplete="email" required>
          <textarea id="alertText" class = "message-box"  placeholder="No alert currently specified, write your alert here ..."></textarea>
          <button id="submitAlert">Submit alert</button>
          <button id="deleteAlert" style="background-color: red; margin-top: 10px;">Remove Current alert</button>
          <p id="alert-message" class = "message"></p>
      </div>

      </div>

      <div class="admin-column">
        <button id="get-site-log" style="margin-bottom: 10px;">Get sign in logs</button>
        <button id="display-signed-in-users" style="margin-bottom: 10px;">Display all signed in users</button>
        <button id="download-signedin" style="margin-bottom: 10px;">Download all signed in users</button>
        <h2>Recent Sign-Ins</h2>
            <div class="table-container" style="max-height: 600px;">
            <table border="1">
              <thead>
                  <tr>
                      <th>#</th>
                      <th>Sign-In Log</th>
                  </tr>
              </thead>
              <tbody id="siteLogsTableBody">
                  <!-- Logs will be inserted here -->
              </tbody>
          </table>
        </div>
      </div>
    </div>

    
    <div class="admin-container-flex" >
      <div class="admin-column">
      <button id="fetch-recent-logs" style="background-color: red; margin-top: 10px; width: 100%">Get recent server logs</button>
      <button id="download-logs" style="background-color: red; margin-top: 10px; width:100%">Download server logs</button>
      </div>
    </div>



  </div>

  <script src="admin-dashboard.js"></script>
</body>
</html>
